<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.xreadup.ai.mapper.AiAnalysisMapper">
    
    <!-- 根据文章ID查询分析结果 -->
    <select id="selectByArticleId" resultType="com.xreadup.ai.model.entity.AiAnalysis">
        SELECT 
            id,
            article_id as articleId,
            title,
            difficulty_level as difficultyLevel,
            keywords,
            summary,
            chinese_translation as chineseTranslation,
            simplified_content as simplifiedContent,
            key_phrases as keyPhrases,
            readability_score as readabilityScore,
            created_at as createdAt,
            updated_at as updatedAt
        FROM ai_analysis
        WHERE article_id = #{articleId}
        LIMIT 1
    </select>
    
    <!-- 根据文章ID删除分析结果 -->
    <delete id="deleteByArticleId">
        DELETE FROM ai_analysis WHERE article_id = #{articleId}
    </delete>
    
    <!-- 检查文章是否已存在分析结果 -->
    <select id="existsByArticleId" resultType="boolean">
        SELECT COUNT(*) > 0 FROM ai_analysis WHERE article_id = #{articleId}
    </select>
    
</mapper>